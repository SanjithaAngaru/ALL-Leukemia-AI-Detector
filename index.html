<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALL Blood Cell Detector</title>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

    <style>
        body {
            font-family: "Inter", sans-serif;
            background: #fafafa;
            margin: 0;
            padding: 0;
            color: #222;
        }

        header {
            background: linear-gradient(90deg, #7a001f, #a3002a);
            color: white;
            padding: 30px 10px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        header h1 {
            margin: 0;
            font-size: 40px;
            font-weight: 800;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 14px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.08);
            border-top: 8px solid #7a001f;
        }

        .section h2 {
            margin-top: 0;
            font-size: 26px;
            color: #7a001f;
            font-weight: 700;
        }

        .info-box {
            background: #f8eef1;
            padding: 18px;
            border-radius: 10px;
            line-height: 1.6;
        }

        #preview {
            margin-top: 20px;
            max-width: 100%;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .result-line {
            background: #f8eef1;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 6px solid #7a001f;
            font-size: 18px;
        }

        .final-result {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        .leukemia {
            color: #7a001f;
        }

        .healthy {
            color: #006400;
        }

        .next-steps {
            margin-top: 20px;
            background: #fff;
            padding: 18px;
            border-radius: 10px;
            border-left: 8px solid #7a001f;
            line-height: 1.6;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        input[type="file"] {
            margin-top: 15px;
            font-size: 16px;
        }

        /* NEW SYMPTOMS SECTION STYLE */
        .symptom-list li {
            margin-bottom: 8px;
            padding-left: 5px;
        }
    </style>
</head>

<body>

<header>
    <h1>Acute Lymphoblastic Leukemia (ALL) Blood Cell Detector</h1>
</header>

<div class="container">

    <!-- LEFT COLUMN -->
    <div>

        <div class="section">
            <h2>About This Project</h2>
            <p>
                This project uses machine learning to analyze blood smear images and identify whether they contain 
                <strong>Healthy Blood Cells</strong> or <strong>ALL Blood Cells</strong>.
            </p>
            <p>
                The model has achieved approximately <strong>75% accuracy</strong> during testing.
            </p>
            <p style="color:#7a001f; font-weight:bold;">
                âš  This tool is NOT a medical diagnostic device.  
                It is for educational purposes only.
            </p>
        </div>

        <div class="section">
            <h2>What is ALL?</h2>
            <div class="info-box">
                Acute Lymphoblastic Leukemia (ALL) is a cancer of the blood and bone marrow. It occurs when the body 
                produces large numbers of immature white blood cells called lymphoblasts. These abnormal cells crowd 
                out healthy blood cells, affecting immunity, oxygen transport, and clotting.
                <br><br>
                ALL is most common in children but can occur at any age. Early medical evaluation is important because 
                ALL is treatable, especially when diagnosed early.
            </div>
        </div>

        <!-- NEW SYMPTOMS SECTION -->
        <div class="section">
            <h2>Common Symptoms of ALL</h2>
            <div class="info-box">
                <ul class="symptom-list">
                    <li>Fatigue or unusual tiredness</li>
                    <li>Frequent infections</li>
                    <li>Easy bruising or bleeding</li>
                    <li>Pale skin</li>
                    <li>Bone or joint pain</li>
                    <li>Swollen lymph nodes</li>
                    <li>Fever or night sweats</li>
                    <li>Shortness of breath</li>
                    <li>Loss of appetite or weight loss</li>
                </ul>
                <strong style="color:#7a001f;">These symptoms can occur in many conditions, not just ALL.  
                Only a licensed healthcare professional can evaluate symptoms or provide diagnosis.</strong>
            </div>
        </div>

    </div>

    <!-- RIGHT COLUMN -->
    <div>

        <div class="section">
            <h2>Upload Your Image</h2>
            <input type="file" id="imageUpload" accept="image/*">
            <img id="preview">
        </div>

        <div class="section">
            <h2>Model Predictions</h2>
            <div id="results"></div>
            <div id="final" class="final-result"></div>
            <div id="steps" class="next-steps"></div>
        </div>

    </div>

</div>

<script>
    const MODEL_URL = "https://teachablemachine.withgoogle.com/models/j9gcdAIwd/";

    let model;

    async function loadModel() {
        if (model) return;
        model = await tmImage.load(MODEL_URL + "model.json", MODEL_URL + "metadata.json");
    }

    document.getElementById("imageUpload").addEventListener("change", async function (event) {
        await loadModel();

        const file = event.target.files[0];
        const img = document.getElementById("preview");
        img.src = window.URL.createObjectURL(file);

        img.onload = async () => {
            const predictions = await model.predict(img);

            const resultsBox = document.getElementById("results");
            const finalBox = document.getElementById("final");
            const stepsBox = document.getElementById("steps");

            resultsBox.innerHTML = "";
            stepsBox.innerHTML = "";

            let bestClass = "";
            let bestProb = 0;

            predictions.forEach(p => {
                const percent = (p.probability * 100).toFixed(2);

                const line = document.createElement("div");
                line.className = "result-line";
                line.textContent = `${p.className}: ${percent}%`;
                resultsBox.appendChild(line);

                if (p.probability > bestProb) {
                    bestProb = p.probability;
                    bestClass = p.className;
                }
            });

            if (bestClass.toLowerCase().includes("all")) {
                finalBox.innerHTML = `Final Result: <span class="leukemia">${bestClass} (${(bestProb * 100).toFixed(2)}%)</span>`;
                stepsBox.innerHTML = `
                    The model detected features commonly associated with ALL Blood Cells.<br><br>
                    This does NOT confirm any medical condition.<br><br>
                    If this were a real medical concern, the next step would be to consult a licensed healthcare professional 
                    who can perform proper diagnostic testing.<br><br>
                    This tool is for educational use only.
                `;
            } else {
                finalBox.innerHTML = `Final Result: <span class="healthy">${bestClass} (${(bestProb * 100).toFixed(2)}%)</span>`;
                stepsBox.innerHTML = `
                    The model did not detect features commonly associated with ALL Blood Cells.<br><br>
                    This does NOT guarantee medical health.<br><br>
                    Only a trained medical professional can evaluate real blood samples and provide an accurate diagnosis.<br><br>
                    This tool is for educational use only.
                `;
            }
        };
    });
</script>

</body>
</html>
